/*!
* 	jQuery Magic Tabs
* 	https://github.com/lukesnowden/magic-tabs
* 	Copyright 2014 Luke Snowden
* 	Released under the MIT license:
* 	http://www.opensource.org/licenses/mit-license.php
*/

(function(e){e.fn.magicTabs=function(t){var t=e.extend({headingTag:"h2",bodyClass:"body",headClass:"head",activeClass:"active"},t);var n=function(n,r){var i=e(n);var s=[];var o;var u=function(){var t=e.Event("created.magic-tabs");t.tabs=o;i.trigger(t)};var a=function(){s=[];o=e('<div class="magic-tabs"></div>');e("> "+t.headingTag,i).each(function(){var n=e(this);var r=[];var i=false;n.nextAll().each(function(){var n=e(this);if(!i&&n[0].tagName.toLowerCase()!==t.headingTag)r.push(n.clone());else i=true});s.push({heading:n.clone(),content:r})})};var f=function(){var n=e("<ul></ul>").addClass("magic-tabs-tabs");var r=e("<ul></ul>").addClass("magic-tabs-contents");for(var a in s){var f=s[a].heading;n.append(e("<li></li>").addClass(t.headClass).html(f.html()));var l=e("<li></li>").addClass(t.bodyClass);for(var c in s[a].content){s[a].content[c].appendTo(l)}l.appendTo(r)}o.append(n);o.append(r);o.insertAfter(i);e("."+t.bodyClass,o).not(":eq(0)").hide();e("."+t.bodyClass,o).eq(0).addClass(t.activeClass);e("."+t.headClass,o).eq(0).addClass(t.activeClass);i.hide();u()};var l=function(){e("."+t.headClass,o).unbind("click.magic-tabs").bind("click.magic-tabs",function(n){n.preventDefault();var r=e(this);var s=function(t){var n=e.Event("closed.magic-tabs");n.head=e(this).prev();n.body=e(this);n.index=e(this).index();i.trigger(n)};var u=function(t){var n=e.Event("opened.magic-tabs");n.head=r;n.body=e(this);n.index=e(this).index();i.trigger(n)};var a=e("."+t.bodyClass+":visible",o);var f=e("."+t.bodyClass,o).eq(r.index());e("."+t.headClass+"."+t.activeClass,o).removeClass(t.activeClass);e("."+t.bodyClass+"."+t.activeClass,o).removeClass(t.activeClass);r.addClass(t.activeClass);f.addClass(t.activeClass);if(a.get(0)!==f.get(0)){f.show(0,u);a.hide(0,s)}})};this.unbind=function(){if(!i.is(":visible")){o.remove();i.show()}};this.rebind=function(){if(i.is(":visible")){a();f();l()}};this.object=function(){return{tabs:o,sections:s}};this.addTab=function(n){var r={head:"",contents:""};new n(r);i.append(e("<"+t.headingTag+"></"+t.headingTag+">").html(r.head));e("<div>"+r.contents+"</div>").children().each(function(){e(this).appendTo(i)});this.unbind();this.rebind()};a();f();l();i.data("magic-tabs",this)};return e(this).each(function(e){new n(this,e)})}})(jQuery)